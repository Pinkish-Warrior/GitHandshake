# Next Steps for Open Source Navigator

This document outlines the immediate next steps for the development of the Open Source Navigator application, building upon the foundational setup.

## 1. Backend: Implement Issue Aggregation âœ…

The core backend service for fetching and storing beginner-friendly issues from GitHub needs to be built.

- **Task:** Create an "Issue Aggregator" service in the `server` application. âœ…
- **Details:** âœ…

  - This service will use the configured GitHub App credentials to make authenticated calls to the GitHub API. âœ…
  - It should fetch issues tagged with labels like `good first issue`, `help wanted`, `beginner`, etc. âœ…
  - The fetched issues should be stored in the PostgreSQL `issues` table. âœ…
- **Endpoint:** Create a new endpoint (e.g., `GET /issues`) to expose the aggregated issues to the frontend. âœ…

## 2. Frontend: Build the User Interface âœ…

With the backend foundation in place, work on the client-side application can begin.

- **Task:** Start building the React/Next.js frontend in the `client` application. âœ…
- **Immediate Steps:**
    1\.  **UI/UX Wireframing:** Design simple wireframes for the main dashboard, focusing on displaying the list of issues and filtering options. ðŸš§ (Design task, not implemented by agent)
    2\.  **Core Components:** Develop the initial set of React components:
        -   `IssueCard`: To display a single issue. âœ…
        -   `IssueList`: To display a list of `IssueCard` components. âœ…
        -   `LanguageFilter`: To allow users to filter issues by programming language. âœ…
        -   `LoginButton`: To initiate the GitHub authentication flow. âœ… (Frontend redirect working)
    3\.  **API Integration:** Connect the frontend to the backend's `/api/issues` endpoint to fetch and display the aggregated issues. âœ…
    4\.  **Authentication:** Implement the frontend logic to handle the GitHub login flow by communicating with the backend authentication endpoints. ðŸš§ (Backend authentication flow skeleton implemented, frontend integration and session management pending)

## 3. Database: Finalize Schema and Seeding âœ…

- **Task:** Review and finalize the database schema. âœ…
- **Details:**

  - Consider if any additional fields are needed for the `issues` or `users` tables based on the data that will be fetched from the GitHub API. âœ…
  - Create a seeding script to populate the database with initial sample data for development and testing purposes. âœ…

---

## Action Plan: Backend Issue Aggregation âœ…

Here is a more detailed breakdown of the steps to implement the Issue Aggregation feature:

1. **Enhance `GithubService`:** âœ…
    - Add methods to authenticate as a GitHub App installation (using JWTs to get an installation access token). âœ…
    - Create a method to fetch issues from the GitHub API, allowing filtering by labels (e.g., `good first issue`). âœ…

2. **Create an `Issues` Module:** âœ…
    - Generate a new `IssuesModule`, `IssuesService`, and `IssuesController` using the NestJS CLI. âœ…
    - The `IssuesService` will contain the core business logic for orchestrating issue fetching and storage. âœ…

3. **Set Up Database Connection:** âœ…
    - Install and configure `@nestjs/typeorm` and `pg` to connect the server application to the PostgreSQL database. âœ…
    - Create a TypeORM entity for the `Issue` to map to the `issues` database table. âœ…

4. **Implement the `GET /issues` Endpoint:** âœ…
    - In the `IssuesController`, create the `GET /issues` endpoint. âœ…
    - This endpoint will use the `IssuesService` to retrieve the list of aggregated issues from the database and return them as a JSON response. âœ…

---

## Current Task: Implement Authentication Session Management ðŸš§

- **Task:** Implement backend session management and frontend state handling for Login/Logout button.
- **Details:**
  - Install and configure `express-session` and `@nestjs/platform-express` for session management on the backend.
  - Modify backend `AuthController` to establish a session upon successful GitHub login.
  - Add backend API endpoints:
    - `GET /api/auth/status`: To check current authentication status.
    - `GET /api/auth/logout`: To destroy the user session and log out.
  - Implement a React Context (`AuthContext`) on the frontend to manage and expose authentication state.
    - Update `LoginButton` component to:
    - Consume `AuthContext` to get login status.
    - Conditionally render "Login with GitHub" or "Logout".
    - Handle logout action by calling `GET /api/auth/logout`.



Here's the plan:
1\. Restart the backend server with npm run server.
2\. Log in again through [http://localhost:3000]
    - this is okay

3\. After redirect, check [http://localhost:3001/api/auth/status] in a new tab; you should see your user profile.
    - {"status":"unauthenticated"}

4\. Test logout by visiting [http://localhost:3001/api/auth/logout]

    - seems to be logged out 
5\. Finally, revisit [http://localhost:3001/api/auth/status]

    - you should see {"status":"unauthenticated"}.
